<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebCola CnD Graph Demo</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        #graph-container {
            width: 100%;
            height: 600px;
            border: 2px solid #007acc;
            border-radius: 8px;
            margin: 20px 0;
        }
        button {
            background-color: #007acc;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
        }
        button:hover {
            background-color: #005a9e;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéØ WebCola CnD Graph Demo</h1>
        <p>This demonstrates how to use the WebColaCnDGraph custom element.</p>
        
        <div>
            <button onclick="loadGraph()">Load Sample Graph</button>
            <button onclick="clearGraph()">Clear Graph</button>
        </div>
        
        <!-- This is how you use the web component in HTML -->
        <webcola-cnd-graph 
            id="graph-container"
            width="800" 
            height="600">
        </webcola-cnd-graph>
        
        <div id="status">Ready to load graph...</div>
    </div>

    <!-- Import the web component -->
    <script type="module">
        try {
            // Import the translators module first to see what's available
            const translators = await import('./dist/translators.mjs');
            console.log('‚úÖ Translators module imported successfully');
            console.log('üì¶ Available exports:', Object.keys(translators));
            console.log('üîç WebColaCnDGraph:', translators.WebColaCnDGraph);
            
            // Check if WebColaCnDGraph is available
            if (translators.WebColaCnDGraph) {
                console.log('‚úÖ WebColaCnDGraph is available:', translators.WebColaCnDGraph);
                const WebColaCnDGraph = translators.WebColaCnDGraph;
                
                // The web component should now be registered automatically
                console.log('üéØ Custom element registered:', customElements.get('webcola-cnd-graph'));
                
                document.getElementById('status').textContent = '‚úÖ WebColaCnDGraph imported successfully! Ready to load graph.';
            } else {
                console.error('‚ùå WebColaCnDGraph not found in translators module');
                document.getElementById('status').textContent = '‚ùå WebColaCnDGraph not available';
            }
        } catch (error) {
            console.error('‚ùå Failed to import translators module:', error);
            document.getElementById('status').textContent = `‚ùå Import failed: ${error.message}`;
        }
        
        // The web component should now be available as <webcola-cnd-graph>
        
        window.loadGraph = async function() {
            const graphElement = document.getElementById('graph-container');
            const statusElement = document.getElementById('status');
            
            try {
                statusElement.textContent = 'Loading graph...';
                
                // Create a sample layout
                const sampleLayout = {
                    nodes: [
                        { id: 'A', name: 'Node A', x: 100, y: 100, color: '#ff6b6b', showLabels: true, attributes: { type: 'Person' } },
                        { id: 'B', name: 'Node B', x: 200, y: 200, color: '#4ecdc4', showLabels: true, attributes: { type: 'Company' } },
                        { id: 'C', name: 'Node C', x: 300, y: 150, color: '#45b7d1', showLabels: true, attributes: { type: 'Product' } }
                    ],
                    edges: [
                        { id: 'e1', source: 'A', target: 'B', label: 'works at', relName: 'employment' },
                        { id: 'e2', source: 'B', target: 'C', label: 'produces', relName: 'production' }
                    ],
                    constraints: [],
                    groups: []
                };
                
                // Call the renderLayout method on the web component
                await graphElement.renderLayout(sampleLayout);
                
                statusElement.textContent = '‚úÖ Graph loaded successfully!';
            } catch (error) {
                console.error('Error loading graph:', error);
                statusElement.textContent = `‚ùå Error: ${error.message}`;
            }
        };
        
        window.clearGraph = function() {
            const graphElement = document.getElementById('graph-container');
            const statusElement = document.getElementById('status');
            
            // Clear the graph by removing all children in the SVG
            const svg = graphElement.shadowRoot?.querySelector('svg');
            if (svg) {
                const container = svg.querySelector('.zoomable');
                if (container) {
                    container.innerHTML = '';
                }
            }
            
            statusElement.textContent = 'Graph cleared.';
        };
    </script>
</body>
</html>
